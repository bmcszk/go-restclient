| Task ID | Description                                                                                                                         | Status    | Dependencies | Notes                                                                                                                                        |
| :------ | :---------------------------------------------------------------------------------------------------------------------------------- | :-------- | :----------- | :------------------------------------------------------------------------------------------------------------------------------------------- |
| T1      | **Analyze existing .http variable processing:** Review `request.go`, `parser.go`, `client.go`                                       | Completed |              | Focus on `resolveVariables` and how `@name=value` is parsed and how programmatic vars are currently handled in `ExecuteFile`.                |
| T2      | **Design hresp variable integration (Revised):** Plan integration with Client-level programmatic vars.                              | Completed | T1           | Programmatic vars on `Client` struct. `resolveAndSubstitute` in `hresp_vars.go` to use `client.programmaticVars`.                            |
| T3      | **Implement `@define` extraction for .hresp:** `extractHrespDefines` in `hresp_vars.go`.                                            | Completed | T2           | Extracts `@name = value` from `.hresp` content.                                                                                              |
| T4      | **Implement core variable substitution for .hresp (Revised):** `resolveAndSubstitute` in `hresp_vars.go`.                             | Completed | T2, T3, T13  | Takes `client *Client` (for its programmaticVars), fileVars. Precedence: client.programmaticVars > fileVars > env > fallback > system. |
| T5      | **Update `ValidateResponses` signature & logic (Revised):** Modify `validator.go`.                                                     | Completed | T4           | Remove `vars ...map[string]interface{}`. Use `client.programmaticVars` via the passed `client` for substitution.                       |
| T6      | **Integrate substitution into validation (Revised):** Call `resolveAndSubstitute` within `ValidateResponses`.                         | Completed | T5           | Pass `client` (for its programmaticVars) and extracted file-vars to `resolveAndSubstitute`.                                                |
| T7      | **Add/Update Unit Tests for .hresp variables (Revised):** In `hresp_vars_test.go`.                                                    | Completed | T4, T13      | Test `resolveAndSubstitute` with client containing programmatic vars.                                                                        |
| T8      | **Implement functionality for T7 tests (Revised):** Make `hresp_vars_test.go` tests pass.                                             | Completed | T7           |                                                                                                                                              |
| T9      | **Test .http variable functionality (Revised):** Ensure no regressions.                                                               | Completed | T8, T14      | Existing tests in `client_test.go` have been updated to use `WithVars` client option.                               |
| T10     | **Documentation (Revised):** Update GoDocs for new/modified functions and client options.                                             | ToDo      | T8, T14      | Cover `WithVars`, modified `Client`, `resolveVariables`, `resolveAndSubstitute`, `ExecuteFile`, `ValidateResponses`.                    |
| T11     | **Review and Refactor (Revised):** Clean up, ensure consistency, PRD met.                                                             | ToDo      | T10          |                                                                                                                                              |
| T12     | **Update `docs/decisions.md` (Revised):** Document new design choices for client-level vars.                                        | ToDo      | T11          |                                                                                                                                              |
| T13     | **Modify `Client` for Programmatic Vars:** Add `programmaticVars map[string]interface{}` to `Client` struct; add `WithVars` option. | Completed | T2           | In `client.go`.                                                                                                                              |
| T14     | **Update `client.resolveVariables` & `ExecuteFile`:** Use `client.programmaticVars`; remove `vars` from `ExecuteFile`.               | Completed | T13          | In `client.go`. Adjust precedence in `resolveVariables`.                                                                                   |
| T15     | **Update existing client tests:** Modify tests using `ExecuteFile` or `ValidateResponses` to reflect signature changes & new options. | Completed | T5, T14      | Updated `client_test.go` and `validator_test.go` files to reflect consolidated test structure.                                                                           |
